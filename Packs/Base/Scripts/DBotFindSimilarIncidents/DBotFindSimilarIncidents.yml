args:
- default: false
  description: Incident id to get prediction, if empty - using the current incident
    id.
  isArray: false
  name: incidentId
  required: false
  secret: false
- auto: PREDEFINED
  default: false
  description: 'Incident''s text fields taken into account to compute similarity -
    Example: commandline, URL.'
  isArray: false
  name: similarTextField
  predefined:
  - comma separated list
  required: false
  secret: false
- auto: PREDEFINED
  default: false
  description: 'Incident''s categorical fields taken into account to compute similarity
    - Example: IP'
  isArray: false
  name: similarCategoricalField
  predefined:
  - comma separated list
  required: false
  secret: false
- auto: PREDEFINED
  default: false
  description: 'Incident''s json fields taken into account to compute similarity -
    Example: CustomFields'
  isArray: false
  name: similarJsonField
  predefined:
  - comma separated list
  required: false
  secret: false
- auto: PREDEFINED
  default: false
  description: Additional incident fields to display but won't be taken into account
    to compute similarity.
  isArray: false
  name: fieldsToDisplay
  predefined:
  - comma separated list
  required: false
  secret: false
- auto: PREDEFINED
  default: false
  description: Incident fields that have to be equal to current incident fields. Help
    to make the query ligher.
  isArray: false
  name: fieldExactMatch
  predefined:
  - comma separated list
  required: false
  secret: false
- auto: PREDEFINED
  default: false
  defaultValue: 'False'
  description: Use a predefined set of fields and CustomFields to compute similarity.
    If yes it will ignore values in similarTextField, similarCategoricalField, similarJsonField
  isArray: false
  name: useAllFields
  predefined:
  - 'True'
  - 'False'
  required: false
  secret: false
- default: false
  defaultValue: 3 months ago
  description: 'The start date by which to filter incidents. Date format will be the
    same as in the incidents query page, for example: "3 days ago", ""2019-01-01T00:00:00
    +0200").'
  isArray: false
  name: fromDate
  required: false
  secret: false
- default: false
  description: 'The end date by which to filter incidents. Date format will be the
    same as in the incidents query page, for example: "3 days ago", ""2019-01-01T00:00:00
    +0200").'
  isArray: false
  name: toDate
  required: false
  secret: false
- default: false
  description: argument for the query - Help to make the query lighter
  isArray: false
  name: query
  required: false
  secret: false
- default: false
  defaultValue: '3000'
  description: Limit of incident to query
  isArray: false
  name: limit
  required: false
  secret: false
- auto: PREDEFINED
  default: false
  defaultValue: 'False'
  description: Aggregate duplicate incidents within diffrerent dates. If includeIndicatorsSimilarity
    is True then aggreagateIncidentsDifferentDate will be False.
  isArray: false
  name: aggreagateIncidentsDifferentDate
  predefined:
  - 'True'
  - 'False'
  required: false
  secret: false
- auto: PREDEFINED
  default: false
  defaultValue: 'False'
  description: If displaying similarity score for each incidentfields.
  isArray: false
  name: showIncidentSimilarityForAllFields
  predefined:
  - 'True'
  - 'False'
  required: false
  secret: false
- default: false
  defaultValue: '0.2'
  description: Keep incidents with higher similarity score than MinimunIncidentSimilarity.
  isArray: false
  name: MinimunIncidentSimilarity
  required: false
  secret: false
- default: false
  defaultValue: '100'
  description: Maximun number of incidents to display.
  isArray: false
  name: maxIncidentsToDisplay
  required: false
  secret: false
- auto: PREDEFINED
  default: false
  defaultValue: 'False'
  description: Show current incident.
  isArray: false
  name: showActualIncident
  predefined:
  - 'True'
  - 'False'
  required: false
  secret: false
- auto: PREDEFINED
  default: false
  defaultValue: 'False'
  description: Include similarity of indicators from DBotFindSimilarIncidentsByIndicators
    in final score.
  isArray: false
  name: includeIndicatorsSimilarity
  predefined:
  - 'True'
  - ' False'
  required: false
  secret: false
- default: false
  description: Minimun number of indicators required related to the incident before
    running the model. Relevant if includeIndicatorsSimilarity is True
  isArray: false
  name: minNumberOfIndicators
  required: false
  secret: false
- auto: PREDEFINED
  default: false
  description: Type of indicators we want to take into account  - If empty use all
    indicators types. Relevant if includeIndicatorsSimilarity is True
  isArray: false
  name: indicatorsTypes
  predefined:
  - comma separated list
  required: false
  secret: false
- default: false
  description: Help to filter out indicators that appear in many incidents. Relevant
    if includeIndicatorsSimilarity is True
  isArray: false
  name: maxIncidentsInIndicatorsForWhiteList
  required: false
  secret: false
comment: Find past similar incidents based on incidents fields similarity, with an
  option to display indicators similarity as well
commonfields:
  id: DBotFindSimilarIncidents
  version: -1
enabled: true
name: DBotFindSimilarIncidents
script: '-'
subtype: python3
system: false
timeout: '0'
type: python
dockerimage: demisto/ml:1.0.0.16162
runas: DBotWeakRole
runonce: true
tests:
- No tests (auto formatted)
fromversion: 5.0.0
