id: OpenCTI Test
version: -1
name: OpenCTI Test
description: test playbook
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: bde27f9d-c151-42a6-8a5f-57d7c96eed79
    type: start
    task:
      id: bde27f9d-c151-42a6-8a5f-57d7c96eed79
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: eec4f919-1b4c-4f45-8766-45340fa7791e
    type: regular
    task:
      id: eec4f919-1b4c-4f45-8766-45340fa7791e
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: f44f8c64-e439-46e3-8de0-afd1915e5db8
    type: regular
    task:
      id: f44f8c64-e439-46e3-8de0-afd1915e5db8
      version: -1
      name: opencti-get-indicators
      script: '|||opencti-get-indicators'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      indicator_types:
        simple: ALL
      last_id: {}
      limit:
        simple: "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: b7801b36-7255-4f68-8148-42fe680ba973
    type: condition
    task:
      id: b7801b36-7255-4f68-8148-42fe680ba973
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: OpenCTI.Indicators.IndicatorsList.type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: OpenCTI.Indicators.IndicatorsList.value
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: OpenCTI.Indicators.IndicatorsList.id
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: 9dedfb91-adce-4c4c-823d-fec1368526f1
    type: regular
    task:
      id: 9dedfb91-adce-4c4c-823d-fec1368526f1
      version: -1
      name: opencti-indicator-delete
      script: '|||opencti-indicator-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      id:
        simple: ${OpenCTI.Indicator.id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: 2c092f08-988e-45a7-8bfe-23c0c3934b1f
    type: regular
    task:
      id: 2c092f08-988e-45a7-8bfe-23c0c3934b1f
      version: -1
      name: opencti-indicator-field-update
      script: '|||opencti-indicator-field-update'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      field:
        simple: score
      id:
        simple: ${OpenCTI.Indicator.id}
      value:
        simple: "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "7":
    id: "7"
    taskid: ce44eeff-331b-4b40-8771-971593e18dba
    type: condition
    task:
      id: ce44eeff-331b-4b40-8771-971593e18dba
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: OpenCTI.Indicator.id
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "8":
    id: "8"
    taskid: e38f25eb-e57d-4955-8fd8-ce745614c077
    type: regular
    task:
      id: e38f25eb-e57d-4955-8fd8-ce745614c077
      version: -1
      name: opencti-indicator-create
      description: Create new indicator.
      script: '|||opencti-indicator-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      created_by:
        simple: ${OpenCTI.Organization.id}
      data:
        simple: '{"value": "BadHost-TestPlaybook"}'
      description:
        simple: Test playbook bad hostname indicator
      external_references_id:
        simple: ${OpenCTI.externalReference.id}
      label:
        simple: testplaybook
      label_id:
        simple: ${OpenCTI.Label.id}
      marking:
        simple: TLP:GREEN
      marking_id: {}
      score:
        simple: "70"
      type:
        simple: Host
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "9":
    id: "9"
    taskid: 2ba1c542-b019-46aa-898d-cb29e909b479
    type: condition
    task:
      id: 2ba1c542-b019-46aa-898d-cb29e909b479
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: OpenCTI.Indicator.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: OpenCTI.Indicator.data
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "10":
    id: "10"
    taskid: bb9c8b06-9209-4c4c-856c-a68160bb3490
    type: title
    task:
      id: bb9c8b06-9209-4c4c-856c-a68160bb3490
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "11":
    id: "11"
    taskid: 6280a15c-d119-4e7b-8eeb-d58b650396ac
    type: regular
    task:
      id: 6280a15c-d119-4e7b-8eeb-d58b650396ac
      version: -1
      name: opencti-indicator-field-remove
      description: Remove field from indicator. Avalible fields to remove - marking
        defenition, label.
      script: '|||opencti-indicator-field-remove'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      field:
        simple: label
      id:
        simple: ${OpenCTI.Indicator.id}
      value:
        simple: ${OpenCTI.Labels.LabelsList.id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: 65dff41e-1cc1-4d54-8a9a-fbac8891f3e0
    type: regular
    task:
      id: 65dff41e-1cc1-4d54-8a9a-fbac8891f3e0
      version: -1
      name: opencti-indicator-field-add
      description: Add field to indicator. Avalible fields to add - marking defenition,
        label.
      script: '|||opencti-indicator-field-add'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      field:
        simple: label
      id:
        simple: ${OpenCTI.Indicator.id}
      value:
        simple: ${OpenCTI.Labels.LabelsList.id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: 8001849e-5a79-48e5-8de8-5cc7331c2bca
    type: regular
    task:
      id: 8001849e-5a79-48e5-8de8-5cc7331c2bca
      version: -1
      name: opencti-organization-list
      description: Get list of all organizations.
      script: '|||opencti-organization-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "15":
    id: "15"
    taskid: 95aa73fa-8523-4909-82d2-d4108bc8a166
    type: regular
    task:
      id: 95aa73fa-8523-4909-82d2-d4108bc8a166
      version: -1
      name: opencti-organization-create
      description: Create organization.
      script: '|||opencti-organization-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      description:
        simple: test playbook organization
      name:
        simple: Test_Organization
      reliability:
        simple: B
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "16":
    id: "16"
    taskid: d1a5d47b-1d3f-4108-81db-08793afbb7ba
    type: condition
    task:
      id: d1a5d47b-1d3f-4108-81db-08793afbb7ba
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: OpenCTI.Organizations.OrganizationsList.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: OpenCTI.Organizations.OrganizationsList.name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "17":
    id: "17"
    taskid: 5f71c9f3-9764-479d-866f-ba08143b1f46
    type: condition
    task:
      id: 5f71c9f3-9764-479d-866f-ba08143b1f46
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: OpenCTI.Organization.id
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
  "18":
    id: "18"
    taskid: 5268780d-acd9-4e59-85b0-b2f7abdedb29
    type: regular
    task:
      id: 5268780d-acd9-4e59-85b0-b2f7abdedb29
      version: -1
      name: opencti-label-list
      description: Get list of all labels.
      script: '|||opencti-label-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      last_run_id: {}
      limit:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
  "19":
    id: "19"
    taskid: e8281939-c385-41f2-8f07-35b4dc6adbc4
    type: condition
    task:
      id: e8281939-c385-41f2-8f07-35b4dc6adbc4
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "12"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: OpenCTI.Labels.LabelsList.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: OpenCTI.Labels.LabelsList.value
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
  "20":
    id: "20"
    taskid: a5416f7a-2046-4d58-80ee-63b9b62aadd3
    type: regular
    task:
      id: a5416f7a-2046-4d58-80ee-63b9b62aadd3
      version: -1
      name: opencti-marking-definition-list
      description: Get list of all marking definitions.
      script: '|||opencti-marking-definition-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      last_run_id: {}
      limit:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
  "21":
    id: "21"
    taskid: e85ab24e-79d2-4307-8c12-049ef7d82eaa
    type: condition
    task:
      id: e85ab24e-79d2-4307-8c12-049ef7d82eaa
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "14"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: OpenCTI.MarkingDefinitions.MarkingDefinitionsList.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: OpenCTI.MarkingDefinitions.MarkingDefinitionsList.value
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
  "22":
    id: "22"
    taskid: ebd558a9-0b3d-43ff-87fc-fc589c0ed393
    type: regular
    task:
      id: ebd558a9-0b3d-43ff-87fc-fc589c0ed393
      version: -1
      name: opencti-external-reference-create
      description: Create external reference.
      script: '|||opencti-external-reference-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      source_name:
        simple: TestPlaybook
      url:
        simple: www.testplaybook.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
  "23":
    id: "23"
    taskid: 29a8a9a7-ef79-4da9-83d1-a8d4fad94f3a
    type: condition
    task:
      id: 29a8a9a7-ef79-4da9-83d1-a8d4fad94f3a
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "26"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: OpenCTI.externalReference.id
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
  "26":
    id: "26"
    taskid: c8cccb97-d102-4e62-8cd7-f338ef09e03f
    type: regular
    task:
      id: c8cccb97-d102-4e62-8cd7-f338ef09e03f
      version: -1
      name: opencti-label-create
      description: Create label.
      script: '|||opencti-label-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      name:
        simple: testplaybook
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
  "27":
    id: "27"
    taskid: 80f3cb4d-451c-4d96-8e43-47a437d71f97
    type: condition
    task:
      id: 80f3cb4d-451c-4d96-8e43-47a437d71f97
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: OpenCTI.Label.id
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
  "28":
    id: "28"
    taskid: 3001f8cf-6aef-43bf-80cf-f017639a3c66
    type: playbook
    task:
      id: 3001f8cf-6aef-43bf-80cf-f017639a3c66
      version: -1
      name: OpenCTI Create Indicator
      playbookName: OpenCTI Create Indicator
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      created_by_id:
        simple: ${OpenCTI.Organizations.OrganizationsList.id}
      data:
        simple: '{"value":"TestPlaybookIncidentCreate"}'
      description:
        simple: test description
      external_reference_source_name:
        simple: test _reference
      external_reference_url:
        simple: www.test.com
      label_name:
        simple: test-label
      marking_definition_id:
        simple: ${OpenCTI.MarkingDefinitions.MarkingDefinitionsList.id}
      score:
        simple: "90"
      type:
        simple: Domain
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
  "29":
    id: "29"
    taskid: c58d486a-e491-4b0f-83da-ebce062b9509
    type: regular
    task:
      id: c58d486a-e491-4b0f-83da-ebce062b9509
      version: -1
      name: opencti-indicator-delete
      script: '|||opencti-indicator-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      id:
        simple: ${OpenCTI.Indicator.id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
  "30":
    id: "30"
    taskid: 883b8689-147b-49ca-8c1c-2b5387d94f54
    type: regular
    task:
      id: 883b8689-147b-49ca-8c1c-2b5387d94f54
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4585,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.5.0
