commonfields:
  id: VirusTotal v3
  version: -1
name: VirusTotal v3
display: VirusTotal v3
fromversion: 5.5.0
category: Data Enrichment & Threat Intelligence
description: Analyze suspicious hashes, URLs, domains and IP addresses
configuration:
- display: ""
  displaypassword: API Key
  name: credentials
  type: 9
  required: true
  hiddenusername: true
- display: Use system proxy settings
  name: proxy
  defaultvalue: ''
  type: 8
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  defaultvalue: ''
  type: 8
  required: false
- display: Is premium API?
  name: is_premium_api
  defaultvalue: 'false'
  type: 8
  required: false
- display: File Threshold. Minimum number of positive results from VT scanners to
    consider the file malicious.
  name: fileThreshold
  defaultvalue: "10"
  type: 0
  required: false
- display: IP Threshold. Minimum number of positive results from VT scanners to consider
    the IP malicious.
  name: ipThreshold
  defaultvalue: "10"
  type: 0
  required: false
- display: URL Threshold. Minimum number of positive results from VT scanners to consider
    the URL malicious.
  name: urlThreshold
  defaultvalue: "10"
  type: 0
  required: false
- display: Domain Threshold. Minimum number of positive results from VT scanners to
    consider the domain malicious.
  name: domainThreshold
  defaultvalue: "10"
  type: 0
  required: false
- display: Preferred Vendors List. CSV list of vendors which are considered more trustworthy.
  name: preferredVendors
  defaultvalue: ""
  type: 12
  required: false
- display: 'Preferred Vendor Threshold. The minimum number of highly trusted vendors
    required to consider a domain, IP address, URL, or file as malicious. '
  name: preferredVendorsThreshold
  defaultvalue: "5"
  type: 0
  required: false
- display: Enable score analyzing by Crowdsourced Yara Rules
  name: crowdsourced_yara_rules_enabled
  defaultvalue: 'true'
  type: 8
  required: false
- display: Crowdsourced Yara Rules Threshold
  name: yaraRulesThreshold
  defaultvalue: '1'
  type: 0
  required: false
- display: Sigma and Intrusion Detection Rules Threshold
  name: SigmaIDSThreshold
  defaultvalue: '5'
  type: 0
  required: false
- display: Domain Popularity Ranking Threshold
  name: domain_popularity_ranking
  defaultvalue: '10000'
  type: 0
  required: false
- display: 'Premium Subscription Only: Relationship Files Threshold'
  name: relationship_threshold
  defaultvalue: '3'
  type: 0
  required: false
script:
  script: ''
  type: python
  subtype: python3
  commands:
  - name: file
    arguments:
    - name: file
      required: true
      default: true
      description: Hash of the file to query. Supports MD5, SHA1, and SHA256.
      isArray: false
    - name: extended_data
      required: false
      description: Will return exteded data (last_analysis_results).
      defaultValue: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - true
      - false
    outputs:
    - contextPath: File.MD5
      description: Bad MD5 hash.
    - contextPath: File.SHA1
      description: Bad SHA1 hash.
    - contextPath: File.SHA256
      description: Bad SHA256 hash.
    - contextPath: File.Malicious.Vendor
      description: For malicious files, the vendor that made the decision.
    - contextPath: File.Malicious.Detections
      description: For malicious files, the total number of detections.
    - contextPath: File.Malicious.TotalEngines
      description: For malicious files, the total number of engines that checked the
        file hash.
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
    - contextPath: DBotScore.Type
      description: The indicator type.
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
    - contextPath: DBotScore.Score
      description: The actual score.
    - contextPath: VirusTotal.File.attributes.type_description
      description: Description of the type
      type: String
    - contextPath: VirusTotal.File.attributes.tlsh
      description: The locality-sensitive hashing.
      type: String
    - contextPath: VirusTotal.File.attributes.exiftool.MIMEType
      description: MIME type of the file.
      type: String
    - contextPath: VirusTotal.File.attributes.names
      description: Names the of the file.
      type: String
    - contextPath: VirusTotal.File.attributes.javascript_info.tags
      description: Tags of the JavaScript
      type: String
    - contextPath: VirusTotal.File.attributes.exiftool.FileType
      description: The file type.
      type: String
    - contextPath: VirusTotal.File.attributes.exiftool.WordCount
      description: Total words in file.
      type: String
    - contextPath: VirusTotal.File.attributes.exiftool.LineCount
      description: Total line in file.
      type: String
    - contextPath: VirusTotal.File.attributes.crowdsourced_ids_stats.info
      description: Number of IDS marked the file as "info"
      type: Number
    - contextPath: VirusTotal.File.attributes.crowdsourced_ids_stats.high
      description: Number of IDS marked the file as "high"
      type: Number
    - contextPath: VirusTotal.File.attributes.crowdsourced_ids_stats.medium
      description: Number of IDS marked the file as "medium"
      type: Number
    - contextPath: VirusTotal.File.attributes.crowdsourced_ids_stats.low
      description: Number of IDS marked the file as "low"
      type: Number
    - contextPath: VirusTotal.File.attributes.sigma_analysis_stats.critical
      description: Number of Sigma analyses marked the file as "critical"
      type: Number
    - contextPath: VirusTotal.File.attributes.sigma_analysis_stats.high
      description: Number of Sigma analyses marked the file as "high"
      type: Number
    - contextPath: VirusTotal.File.attributes.sigma_analysis_stats.medium
      description: Number of Sigma analyses marked the file as "medium"
      type: Number
    - contextPath: VirusTotal.File.attributes.sigma_analysis_stats.low
      description: Number of Sigma analyses marked the file as "low"
      type: Number
    - contextPath: VirusTotal.File.attributes.exiftool.MIMEEncoding
      description: The MIME encoding,
      type: String
    - contextPath: VirusTotal.File.attributes.exiftool.FileTypeExtension
      description: The filetype extensions.
      type: String
    - contextPath: VirusTotal.File.attributes.exiftool.Newlines
      description: Number of newlines signs.
      type: String
    - contextPath: VirusTotal.File.attributes.trid.file_type
      description: The file type.
      type: String
    - contextPath: VirusTotal.File.attributes.trid.probability
      description:
      type: Number
    - contextPath: VirusTotal.File.attributes.crowdsourced_yara_results.description
      description: Description of yara rule.
      type: String
    - contextPath: VirusTotal.File.attributes.crowdsourced_yara_results.source
      description: Source of the yara rule.
      type: String
    - contextPath: VirusTotal.File.attributes.crowdsourced_yara_results.author
      description: Author of the yara rule.
      type: String
    - contextPath: VirusTotal.File.attributes.crowdsourced_yara_results.ruleset_name
      description: Ruleset name of the yara rules.
      type: String
    - contextPath: VirusTotal.File.attributes.crowdsourced_yara_results.rule_name
      description: Name of the yara rule.
      type: String
    - contextPath: VirusTotal.File.attributes.crowdsourced_yara_results.ruleset_id
      description: ID of the yara rule.
      type: String
    - contextPath: VirusTotal.File.attributes.names
      description: Names of the file.
      type: String
    - contextPath: VirusTotal.File.attributes.last_modification_date
      description: The last modification date in epoch
      type: Number
    - contextPath: VirusTotal.File.attributes.type_tag
      description: Tag of the type.
      type: String
    - contextPath: VirusTotal.File.attributes.total_votes.harmless
      description: Total harmless votes
      type: Number
    - contextPath: VirusTotal.File.attributes.total_votes.malicious
      description: Total malicious votes
      type: Number
    - contextPath: VirusTotal.File.attributes.size
      description: Size of the file
      type: Number
    - contextPath: VirusTotal.File.attributes.popular_threat_classification.suggested_threat_label
      description: Suggested thread label
      type: String
    - contextPath: VirusTotal.File.attributes.popular_threat_classification.popular_threat_name
      description: The populat thread name.
      type: Number
    - contextPath: VirusTotal.File.attributes.times_submitted
      description: Number of times the file submitted.
      type: Number
    - contextPath: VirusTotal.File.attributes.last_submission_date
      description: Last submission date in epoch.
      type: Number
    - contextPath: VirusTotal.File.attributes.downloadable
      description: Is file downloadable.
      type: Boolean
    - contextPath: VirusTotal.File.attributes.sha256
      description: SHA-256 of the file
      type: String
    - contextPath: VirusTotal.File.attributes.type_extension
      description: Extension of the type.
      type: String
    - contextPath: VirusTotal.File.attributes.tags
      description: File tags.
      type: String
    - contextPath: VirusTotal.File.attributes.last_analysis_date
      description: Last analysis date in epoch.
      type: Number
    - contextPath: VirusTotal.File.attributes.unique_sources
      description: Unique sources.
      type: Number
    - contextPath: VirusTotal.File.attributes.first_submission_date
      description: First submission date in epoch.
      type: Number
    - contextPath: VirusTotal.File.attributes.ssdeep
      description: SSDeep hash.
      type: String
    - contextPath: VirusTotal.File.attributes.md5
      description: MD5 hash.
      type: String
    - contextPath: VirusTotal.File.attributes.sha1
      description: SHA-1 hash.
      type: String
    - contextPath: VirusTotal.File.attributes.magic
      description: ''
      type: String
    - contextPath: VirusTotal.File.attributes.last_analysis_stats.harmless
      description: The number of engines found the indicator as harmless.
      type: Number
    - contextPath: VirusTotal.File.attributes.last_analysis_stats.type-unsupported
      description: ''
      type: Number
    - contextPath: VirusTotal.File.attributes.last_analysis_stats.suspicious
      description: The number of engines found the indicator as suspicious.
      type: Number
    - contextPath: VirusTotal.File.attributes.last_analysis_stats.confirmed-timeout
      description: The number of engines confirmed the timeout of the indicator.
      type: Number
    - contextPath: VirusTotal.File.attributes.last_analysis_stats.timeout
      description: The number of engines timeoutted to the indicator.
      type: Number
    - contextPath: VirusTotal.File.attributes.last_analysis_stats.failure
      description: The number of failed analyses engines.
      type: Number
    - contextPath: VirusTotal.File.attributes.last_analysis_stats.malicious
      description: The number of engines found the indicator as malicious.
      type: Number
    - contextPath: VirusTotal.File.attributes.last_analysis_stats.undetected
      description: The number of engines that could mot detect the indicator.
      type: Number
    - contextPath: VirusTotal.File.attributes.meaningful_name
      description: Meaningful name of the file.
      type: String
    - contextPath: VirusTotal.File.attributes.reputation
      description: The reputation of the file.
      type: Number
    - contextPath: VirusTotal.File.type
      description: Type of the indicator (file).
      type: String
    - contextPath: VirusTotal.File.id
      description: Type ID the indicator.
      type: String
    - contextPath: VirusTotal.File.links.self
      description: Link to the response.
      type: String
    description: Checks the file reputation of the specified hash.
  - name: ip
    arguments:
    - name: ip
      required: true
      default: true
      description: IP address to check.
      isArray: false
    - name: extended_data
      required: false
      description: Will return exteded data (last_analysis_results).
      defaultValue: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - true
      - false
    outputs:
    - contextPath: IP.Address
      description: Bad IP address.
    - contextPath: IP.ASN
      description: Bad IP ASN.
    - contextPath: IP.Geo.Country
      description: Bad IP country.
    - contextPath: IP.Malicious.Vendor
      description: For malicious IPs, the vendor that made the decision.
    - contextPath: IP.Malicious.Description
      description: For malicious IPs, the reason that the vendor made the decision.
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
    - contextPath: DBotScore.Type
      description: The indicator type.
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
    - contextPath: DBotScore.Score
      description: The actual score.
    - contextPath: VirusTotal.IP.attributes.regional_internet_registry
      description: Regional Internet Registry
      type: String
    - contextPath: VirusTotal.IP.attributes.jarm
      description: JARM data
      type: String
    - contextPath: VirusTotal.IP.attributes.network
      description: Network data
      type: String
    - contextPath: VirusTotal.IP.attributes.country
      description: The country that IP from
      type: String
    - contextPath: VirusTotal.IP.attributes.as_owner
      description: IP Owner
      type: String
    - contextPath: VirusTotal.IP.attributes.last_analysis_stats.harmless
      description: The number of engines found the domain as harmless.
      type: Number
    - contextPath: VirusTotal.IP.attributes.last_analysis_stats.malicious
      description: The number of engines found the indicator as malicious.
      type: Number
    - contextPath: VirusTotal.IP.attributes.last_analysis_stats.suspicious
      description: The number of engines found the indicator as malicious.
      type: Number
    - contextPath: VirusTotal.IP.attributes.last_analysis_stats.undetected
      description: The number of engines that could mot detect the indicator.
      type: Number
    - contextPath: VirusTotal.IP.attributes.last_analysis_stats.timeout
      description: The number of engines timeoutted to the indicator.
      type: Number
    - contextPath: VirusTotal.IP.attributes.asn
      description: ASN data
      type: Number
    - contextPath: VirusTotal.IP.attributes.whois_date
      description: WHOIS Date in epoch format
      type: Number
    - contextPath: VirusTotal.IP.attributes.reputation
      description: IP Repuration
      type: Number
    - contextPath: VirusTotal.IP.attributes.last_modification_date
      description: Last modification date, epoch format.
      type: Number
    - contextPath: VirusTotal.IP.attributes.total_votes.harmless
      description: Total harmless votes
      type: Number
    - contextPath: VirusTotal.IP.attributes.total_votes.malicious
      description: Total malicious votes
      type: Number
    - contextPath: VirusTotal.IP.attributes.continent
      description: The continent of the IP
      type: String
    - contextPath: VirusTotal.IP.attributes.whois
      description: WHOIS data
      type: String
    - contextPath: VirusTotal.IP.type
      description: Indicator type (ip)
      type: String
    - contextPath: VirusTotal.IP.id
      description: ID of the IP
      type: String
    - contextPath: VirusTotal.IP.links.self
      description: ''
      type: String
    description: Checks the reputation of an IP address.
  - name: url
    arguments:
    - name: url
      required: true
      default: true
      description: URL to check.
      isArray: false
    - name: extended_data
      required: false
      description: Will return exteded data (last_analysis_results).
      defaultValue: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - true
      - false
    outputs:
    - contextPath: URL.Data
      description: Bad URLs found.
    - contextPath: URL.Malicious.Vendor
      description: For malicious URLs, the vendor that made the decision.
    - contextPath: URL.Malicious.Description
      description: For malicious URLs, the reason that the vendor made the decision.
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
    - contextPath: DBotScore.Type
      description: The indicator type.
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
    - contextPath: DBotScore.Score
      description: The actual score.
    - contextPath: VirusTotal.URL.attributes.favicon.raw_md5
      description: The MD5 of the URL
      type: String
    - contextPath: VirusTotal.URL.attributes.favicon.dhash
      description: Difference hash
      type: String
    - contextPath: VirusTotal.URL.attributes.last_modification_date
      description: Last modification date, epoch format.
      type: Number
    - contextPath: VirusTotal.URL.attributes.times_submitted
      description: The Number of time the url has been submitted.
      type: Number
    - contextPath: VirusTotal.URL.attributes.total_votes.harmless
      description: Total harmless votes
      type: Number
    - contextPath: VirusTotal.URL.attributes.total_votes.malicious
      description: Total malicious votes
      type: Number
    - contextPath: VirusTotal.URL.attributes.threat_names
      description: Name of the threats found.
      type: String
    - contextPath: VirusTotal.URL.attributes.last_submission_date
      description: The last submission date, in epoch.
      type: Number
    - contextPath: VirusTotal.URL.attributes.last_http_response_content_length
      description: The last HTTPS response length.
      type: Number
    - contextPath: VirusTotal.URL.attributes.last_http_response_headers.date
      description: The last response header date.
      type: Date
    - contextPath: VirusTotal.URL.attributes.last_http_response_headers.x-sinkhole
      description: DNS Sinkhole from last response.
      type: String
    - contextPath: VirusTotal.URL.attributes.last_http_response_headers.content-length
      description: The content length of the last response.
      type: String
    - contextPath: VirusTotal.URL.attributes.last_http_response_headers.content-type
      description: The content type of the last response.
      type: String
    - contextPath: VirusTotal.URL.attributes.reputation
      description: Reputation of the indicator.
      type: Number
    - contextPath: VirusTotal.URL.attributes.last_analysis_date
      description: The date of the last analysis in epoch.
      type: Number
    - contextPath: VirusTotal.URL.attributes.has_content
      description: Is the url has content in it.
      type: Boolean
    - contextPath: VirusTotal.URL.attributes.first_submission_date
      description: The first submission date in epoch.
      type: Number
    - contextPath: VirusTotal.URL.attributes.last_http_response_content_sha256
      description: The SHA-256 hash of the content of the last response.
      type: String
    - contextPath: VirusTotal.URL.attributes.last_http_response_code
      description: Last response status code.
      type: Number
    - contextPath: VirusTotal.URL.attributes.last_final_url
      description: Last final URL.
      type: String
    - contextPath: VirusTotal.URL.attributes.url
      description: The URL itself.
      type: String
    - contextPath: VirusTotal.URL.attributes.title
      description: Title of the page.
      type: String
    - contextPath: VirusTotal.URL.attributes.last_analysis_stats.harmless
      description: The number of engines found the domain as harmless.
      type: Number
    - contextPath: VirusTotal.URL.attributes.last_analysis_stats.malicious
      description: The number of engines found the indicator as malicious.
      type: Number
    - contextPath: VirusTotal.URL.attributes.last_analysis_stats.suspicious
      description: The number of engines found the indicator as malicious.
      type: Number
    - contextPath: VirusTotal.URL.attributes.last_analysis_stats.undetected
      description: The number of engines that could mot detect the indicator.
      type: Number
    - contextPath: VirusTotal.URL.attributes.last_analysis_stats.timeout
      description: The number of engines timeoutted to the indicator.
      type: Number
    - contextPath: VirusTotal.URL.attributes.outgoing_links
      description: Outgoing links of the URL page.
      type: String
    - contextPath: VirusTotal.URL.type
      description: Type of the indicator (url)
      type: String
    - contextPath: VirusTotal.URL.id
      description: ID of the indicator
      type: String
    - contextPath: VirusTotal.URL.links.self
      description: Link to the response.
      type: String
    description: Checks the reputation of a URL.
  - name: domain
    arguments:
    - name: domain
      required: true
      default: true
      description: Domain name to check.
      isArray: false
    - name: extended_data
      required: false
      description: Will return exteded data (last_analysis_results).
      defaultValue: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - true
      - false
    outputs:
    - contextPath: Domain.Name
      description: Bad domain found.
    - contextPath: Domain.Malicious.Vendor
      description: For malicious domains, the vendor that made the decision.
    - contextPath: Domain.Malicious.Description
      description: For malicious domains, the reason that the vendor made the decision.
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
    - contextPath: DBotScore.Type
      description: The indicator type.
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
    - contextPath: DBotScore.Score
      description: The actual score.
    - contextPath: Domain.VirusTotal.DownloadedHashes
      description: Hashes of files that were downloaded from this domain.
    - contextPath: Domain.VirusTotal.CommunicatingHashes
      description: Hashes of files that communicated with this domain in a sandbox.
    - contextPath: Domain.VirusTotal.Resolutions.ip_address
      description: IP addresses that resolved to this domain.
    - contextPath: VirusTotal.Domain.attributes.last_dns_records.type
      description: The type of the last DNS records
      type: String
    - contextPath: VirusTotal.Domain.attributes.last_dns_records.value
      description: The value of the last DNS records
      type: String
    - contextPath: VirusTotal.Domain.attributes.last_dns_records.ttl
      description: The Time To Live of the last DNS records
      type: Number
    - contextPath: VirusTotal.Domain.attributes.jarm
      description: JARM data
      type: String
    - contextPath: VirusTotal.Domain.attributes.whois
      description: WHOIS data
      type: String
    - contextPath: VirusTotal.Domain.attributes.last_dns_records_date
      description: The last DNS records date, epoch format.
      type: Number
    - contextPath: VirusTotal.Domain.attributes.last_analysis_stats.harmless
      description: The number of engines found the domain as harmless.
      type: Number
    - contextPath: VirusTotal.Domain.attributes.last_analysis_stats.malicious
      description: The number of engines found the indicator as malicious.
      type: Number
    - contextPath: VirusTotal.Domain.attributes.last_analysis_stats.suspicious
      description: The number of engines found the indicator as malicious.
      type: Number
    - contextPath: VirusTotal.Domain.attributes.last_analysis_stats.undetected
      description: The number of engines that could mot detect the indicator.
      type: Number
    - contextPath: VirusTotal.Domain.attributes.last_analysis_stats.timeout
      description: The number of engines timeoutted to the indicator.
      type: Number
    - contextPath: VirusTotal.Domain.attributes.favicon.raw_md5
      description: MD5 of the domain
      type: String
    - contextPath: VirusTotal.Domain.attributes.favicon.dhash
      description: Favicon hash
      type: String
    - contextPath: VirusTotal.Domain.attributes.reputation
      description: Reputation
      type: Number
    - contextPath: VirusTotal.Domain.attributes.registrar
      description: Registrar information
      type: String
    - contextPath: VirusTotal.Domain.attributes.last_update_date
      description: Last updated date, epoch format.
      type: Number
    - contextPath: VirusTotal.Domain.attributes.last_modification_date
      description: Last modification date, epoch format.
      type: Number
    - contextPath: VirusTotal.Domain.attributes.creation_date
      description: Createion date, epoch format.
      type: Number
    - contextPath: VirusTotal.Domain.attributes.total_votes.harmless
      description: Total harmless votes
      type: Number
    - contextPath: VirusTotal.Domain.attributes.total_votes.malicious
      description: Total malicious votes
      type: Number
    - contextPath: VirusTotal.Domain.type
      description: Type of indicator (domain)
      type: String
    - contextPath: VirusTotal.Domain.id
      description: ID of the domain
      type: String
    - contextPath: VirusTotal.Domain.links.self
      description: Link to the domain investigation.
      type: String
    description: Checks the reputation of a domain.
  - name: vt-file-scan
    arguments:
    - name: entryID
      required: true
      default: true
      description: The file entry ID to submit.
    - name: uploadURL
      description: Premium API extension. Special upload URL for files larger than
        32 MB. Can be aquired from vt-file-scan-upload-url.
    outputs:
      - contextPath: VirusTotal.Submission.type
        description: The submission type
        type: String
      - contextPath: VirusTotal.Submission.id
        description: The ID of the submission
        type: String
      - contextPath: VirusTotal.Submission.EntryID
        description: The Entry ID of the file detonated.
        type: String
      - contextPath: VirusTotal.Submission.Extension
        description: File extension.
        type: String
      - contextPath: VirusTotal.Submission.Info
        description: File info
        type: String
      - contextPath: VirusTotal.Submission.MD5
        description: MD5 hash of the file.
        type: String
      - contextPath: VirusTotal.Submission.Name
        description: File's name
        type: String
      - contextPath: VirusTotal.Submission.SHA1
        description: SHA-1 hash of the file
        type: String
      - contextPath: VirusTotal.Submission.SHA256
        description: SHA-256 of the file.
        type: String
      - contextPath: VirusTotal.Submission.SHA512
        description: SHA-512 of the file
        type: String
      - contextPath: VirusTotal.Submission.SSDeep
        description: SSDeep of the file.
        type: String
      - contextPath: VirusTotal.Submission.Size
        description: Size of the file.
        type: Number
      - contextPath: VirusTotal.Submission.Type
        description: The type of the submission (analysis).
        type: String
    description: Submits a file for scanning.
  - name: vt-file-rescan
    arguments:
    - name: file
      required: true
      default: true
      description: Hash of the file to re-scan. Supports MD5, SHA1, and SHA256.
    outputs:
      - contextPath: VirusTotal.Submission.Type
        description: The type of the submission (analysis).
        type: String
      - contextPath: VirusTotal.Submission.id
        description: The ID of the submission
        type: String
      - contextPath: VirusTotal.Submission.hash
        description: The indicator sent to rescan.
        type: String
    description: Re-scans an already submitted file. This avoids having to upload
      the file again.
  - name: vt-url-scan
    arguments:
    - name: url
      required: true
      default: true
      description: The URL to scan.
    outputs:
      - contextPath: VirusTotal.Submission.Type
        description: The type of the submission (analysis).
        type: String
      - contextPath: VirusTotal.Submission.id
        description: The ID of the submission
        type: String
      - contextPath: VirusTotal.Submission.hash
        description: The indicator sent to rescan.
        type: String
    description: Scans a specified URL.
  - name: vt-comments-add
    arguments:
    - name: resource
      required: true
      default: false
      description: The file hash (MD5, SHA1, orSHA256), Domain, URL or IP you're commenting
        on.
    - name: resource_type
      required: true
      default: false
      description: The type of the resource you're commenting one.
      auto: PREDEFINED
      predefined:
      - ip
      - url
      - domain
      - hash
    - name: comment
      required: true
      description: 'The actual review, which you can tag by using the "#" twitter-like
        syntax, for example, #disinfection #zbot, and reference users using the "@"
        syntax, for example, @VirusTotalTeam).'
    description: Adds comments to files and URLs.
  - name: vt-file-scan-upload-url
    arguments: []
    outputs:
    - contextPath: VirusTotal.FileUploadURL
      description: The special upload URL for large files.
    description: Private API. Get a special URL for files larger than 32 MB.
  - name: vt-comments-get
    arguments:
    - name: resource
      required: true
      default: false
      description: The file hash (MD5, SHA1, orSHA256), Domain, URL or IP from which
        you're retrieving comments.
    - name: resource_type
      required: true
      default: false
      description: The type of the resource you're commenting one.
      auto: PREDEFINED
      predefined:
      - ip
      - url
      - domain
      - file
    - name: limit
      description: Maximum comments to fetch
      defaultValue: 10
    outputs:
      - contextPath: VirusTotal.Comments.id
        description: ID Commented on (the given hash, domain, url or ip)
        type: String
      - contextPath: VirusTotal.Comments.comments.attributes.date
        description: The date of the comment in epoch.
        type: Number
      - contextPath: VirusTotal.Comments.comments.attributes.text
        description: The text of the comment.
        type: String
      - contextPath: VirusTotal.Comments.comments.attributes.votes.positive
        description: Number of positive votes.
        type: Number
      - contextPath: VirusTotal.Comments.comments.attributes.votes.abuse
        description: Number of abuse votes.
        type: Number
      - contextPath: VirusTotal.Comments.comments.attributes.votes.negative
        description: Number of negative votes.
        type: Number
      - contextPath: VirusTotal.Comments.comments.attributes.html
        description: The HTML content.
        type: String
      - contextPath: VirusTotal.Comments.comments.type
        description: The type of the comment.
        type: String
      - contextPath: VirusTotal.Comments.comments.id
        description:
        type: String
      - contextPath: VirusTotal.Comments.comments.links.self
        description: Link to the request
        type: String
    description: Retrieves comments for a given resource.
  - name: vt-comments-get-by-id
    arguments:
    - name: id
      required: true
      default: true
      description: The comment's id. Can be retrieved from vt-comments-get.
    outputs:
      - contextPath: VirusTotal.Comments.id
        description: ID Commented on (the given hash, domain, url or ip)
        type: String
      - contextPath: VirusTotal.Comments.comments.attributes.date
        description: The date of the comment in epoch.
        type: Number
      - contextPath: VirusTotal.Comments.comments.attributes.text
        description: The text of the comment.
        type: String
      - contextPath: VirusTotal.Comments.comments.attributes.votes.positive
        description: Number of positive votes.
        type: Number
      - contextPath: VirusTotal.Comments.comments.attributes.votes.abuse
        description: Number of abuse votes.
        type: Number
      - contextPath: VirusTotal.Comments.comments.attributes.votes.negative
        description: Number of negative votes.
        type: Number
      - contextPath: VirusTotal.Comments.comments.attributes.html
        description: The HTML content.
        type: String
      - contextPath: VirusTotal.Comments.comments.type
        description: The type of the comment.
        type: String
      - contextPath: VirusTotal.Comments.comments.id
        description:
        type: String
      - contextPath: VirusTotal.Comments.comments.links.self
        description: Link to the request
        type: String
    description: Retrieves a comment by comment ID.
  - name: vt-search
    description: Search for an indicator in Virus Total.
    arguments:
    - name: query
      required: true
      default: true
      description: 'This endpoint searches any of the following: A file hash, A URL,
        A domain, A IP address, Tag comments.'
    - name: extended_data
      required: false
      description: Will return exteded data (last_analysis_results).
      defaultValue: false
      isArray: false
      auto: PREDEFINED
      predefined:
        - true
        - false
    - name: limit
      description: Maximum results to fetch.
      defaultValue: 10
    outputs:
      - contextPath: VirusTotal.SearchResults.attributes.last_analysis_stats.harmless
        description: Number of engines found the indicator harmless.
        type: Number
      - contextPath: VirusTotal.SearchResults.attributes.last_analysis_stats.malicious
        description: Number of engines found the indicator malicious.
        type: Number
      - contextPath: VirusTotal.SearchResults.attributes.last_analysis_stats.suspicious
        description: Number of engines found the indicator suspicious.
        type: Number
      - contextPath: VirusTotal.SearchResults.attributes.last_analysis_stats.undetected
        description: Number of engines the could not detect the indicator.
        type: Number
      - contextPath: VirusTotal.SearchResults.attributes.last_analysis_stats.timeout
        description: Number of engines got timeout.
        type: Number
      - contextPath: VirusTotal.SearchResults.attributes.reputation
        description: indicator's reputation
        type: Number
      - contextPath: VirusTotal.SearchResults.attributes.last_modification_date
        description: The last modification date in epoch.
        type: Number
      - contextPath: VirusTotal.SearchResults.attributes.total_votes.harmless
        description: Total votes of harmless.
        type: Number
      - contextPath: VirusTotal.SearchResults.attributes.total_votes.malicious
        description: Total votes of malicious.
        type: Number
      - contextPath: VirusTotal.SearchResults.type
        description: The type of the indicator (ip_address, domain, url, file)
        type: String
      - contextPath: VirusTotal.SearchResults.id
        description: ID of the indicator
        type: String
      - contextPath: VirusTotal.SearchResults.links.self
        description: Link to the response
        type: String
  - name: vt-file-sandbox-report
    arguments:
    - name: file
      required: true
      default: true
      description: Hash of the file to query. Supports MD5, SHA1, and SHA256.
    - name: limit
      description: Maximum results to fetch.
      defaultValue: 10
    outputs:
      - contextPath: SandboxReport.attributes.analysis_date
        description: The date of the analysis, epoch time.
        type: Number
      - contextPath: SandboxReport.attributes.behash
        description: Behash of the
        type: String
      - contextPath: SandboxReport.attributes.command_executions
        description: Which command were executed.
        type: String
      - contextPath: SandboxReport.attributes.dns_lookups.hostname
        description: Hostnames found in the lookup.
        type: String
      - contextPath: SandboxReport.attributes.dns_lookups.resolved_ips
        description: Which IPs were resolved.
        type: String
      - contextPath: SandboxReport.attributes.files_attribute_changed
        description: Which file's attributes changed
        type: String
      - contextPath: SandboxReport.attributes.has_html_report
        description: Is there a HTML report?
        type: Boolean
      - contextPath: SandboxReport.attributes.has_pcap
        description: Whatever the IP has a PCAP file.
        type: Boolean
      - contextPath: SandboxReport.attributes.http_conversations.request_method
        description: The request method of the http conversation.
        type: String
      - contextPath: SandboxReport.attributes.http_conversations.response_headers.Cache-Control
        description: The Cache-Control method of the response header..
        type: String
      - contextPath: SandboxReport.attributes.http_conversations.response_headers.Connection
        description: The connection of the response header..
        type: String
      - contextPath: SandboxReport.attributes.http_conversations.response_headers.Content-Length
        description: THe Content-Length of the response header..
        type: String
      - contextPath: SandboxReport.attributes.http_conversations.response_headers.Content-Type
        description: The Content-Type of the response header.
        type: String
      - contextPath: SandboxReport.attributes.http_conversations.response_headers.Pragma
        description: The pragma of the  response header.
        type: String
      - contextPath: SandboxReport.attributes.http_conversations.response_headers.Server
        description: The server of the response header.
        type: String
      - contextPath: SandboxReport.attributes.http_conversations.response_headers.Status-Line
        description: The Status-Line of the response header
        type: String
      - contextPath: SandboxReport.attributes.http_conversations.response_status_code
        description: The response status code.
        type: Number
      - contextPath: SandboxReport.attributes.http_conversations.url
        description: The conversation URL.
        type: String
      - contextPath: SandboxReport.attributes.last_modification_date
        description: Last modified data in epoch.
        type: Number
      - contextPath: SandboxReport.attributes.modules_loaded
        description: Loaded modules.
        type: String
      - contextPath: SandboxReport.attributes.mutexes_created
        description: Which mutexes created.
        type: String
      - contextPath: SandboxReport.attributes.mutexes_opened
        description: Which mutexes opend.
        type: String
      - contextPath: SandboxReport.attributes.processes_created
        description: Which mutexes created.
        type: String
      - contextPath: SandboxReport.attributes.processes_tree.name
        description: The name of the process tree.
        type: String
      - contextPath: SandboxReport.attributes.processes_tree.process_id
        description: The ID of the process.
        type: String
      - contextPath: SandboxReport.attributes.registry_keys_deleted
        description: Deleted registry keys.
        type: String
      - contextPath: SandboxReport.attributes.registry_keys_set.key
        description: Key of the registry key.
        type: String
      - contextPath: SandboxReport.attributes.registry_keys_set.value
        description: Value of the registry key.
        type: String
      - contextPath: SandboxReport.attributes.sandbox_name
        description: The name of the sandbox.
        type: String
      - contextPath: SandboxReport.attributes.services_started
        description: Which services started.
        type: String
      - contextPath: SandboxReport.attributes.verdicts
        description: verdicts.
        type: String
      - contextPath: SandboxReport.id
        description: The IP analyzed.
        type: String
      - contextPath: SandboxReport.links.self
        description: Link to the response.
        type: String
      - contextPath: SandboxReport.attributes.files_dropped.path
        description: Path of the file dropped.
        type: String
      - contextPath: SandboxReport.attributes.files_dropped.sha256
        description: SHA-256 of dropped files.
        type: String
      - contextPath: SandboxReport.attributes.files_opened
        description: Which files opened.
        type: String
      - contextPath: SandboxReport.attributes.files_written
        description: Which files were written.
        type: String
      - contextPath: SandboxReport.attributes.ip_traffic.destination_ip
        description: Destination IP in the traffic
        type: String
      - contextPath: SandboxReport.attributes.ip_traffic.destination_port
        description: Destination port in the traffic
        type: Number
      - contextPath: SandboxReport.attributes.ip_traffic.transport_layer_protocol
        description: Transport layer protocol in the traffic
        type: String
      - contextPath: SandboxReport.attributes.registry_keys_opened
        description: Which registry keys opened.
        type: String
      - contextPath: SandboxReport.attributes.tags
        description: tags of the DNS data.
        type: String
      - contextPath: SandboxReport.attributes.files_copied.destination
        description: Destination of the files copied.
        type: String
      - contextPath: SandboxReport.attributes.files_copied.source
        description: Source of the files copied.
        type: String
      - contextPath: SandboxReport.attributes.permissions_requested
        description: Which permissions where requested.
        type: String
      - contextPath: SandboxReport.attributes.processes_injected
        description: Which processes injected.
        type: String
      - contextPath: SandboxReport.attributes.processes_terminated
        description: Which processes terminated.
        type: String
      - contextPath: SandboxReport.attributes.processes_tree.children.name
        description: The name of the children of the process.
        type: String
      - contextPath: SandboxReport.attributes.processes_tree.children.process_id
        description: The ID of the children of the process.
        type: String
      - contextPath: SandboxReport.attributes.services_opened
        description: Which services were opened.
        type: String
      - contextPath: SandboxReport.attributes.text_highlighted
        description: Which text were highlighted.
        type: String
      - contextPath: SandboxReport.attributes.calls_highlighted
        description: Which calls were highlighted.
        type: String
      - contextPath: SandboxReport.attributes.processes_tree.children.time_offset
        description: The time offset of the children in the process.
        type: Number
      - contextPath: SandboxReport.links.self
        description: link to the response
        type: String
      - contextPath: SandboxReport.meta.count
        description: How many object were found in the attributes.
        type: Number
    description: Retrives a behavioural relationship of the given file hash.
  - name: vt-passive-dns-data
    description: Returns passive DNS records by indicator.
    arguments:
    - name: ip
      required: true
      default: true
      description: IP to get its DNS data.
    - name: limit
      description: Maximum results to fetch.
      defaultValue: 10
    outputs:
      - contextPath: VirusTotal.PassiveDNS(val.id == obj.id).attributes.date
        description: Date of the DNS analysis, epoch time.
        type: Number
      - contextPath: VirusTotal.PassiveDNS(val.id == obj.id).attributes.host_name
        description: The DNS host name.
        type: String
      - contextPath: VirusTotal.PassiveDNS(val.id == obj.id).attributes.ip_address
        description: DNS IP Address
        type: String
      - contextPath: VirusTotal.PassiveDNS(val.id == obj.id).attributes.resolver
        description: Resolver's name
        type: String
      - contextPath: VirusTotal.PassiveDNS(val.id == obj.id).id
        description: The ID of the resolution
        type: String
      - contextPath: VirusTotal.PassiveDNS(val.id == obj.id).links.self
        description: link to the resolution
        type: String
      - contextPath: VirusTotal.PassiveDNS(val.id == obj.id).type
        description: type of the resolution
        type: String
  - name: vt-analysis-get
    arguments:
    - name: id
      required: true
      default: true
      description: ID of the analysis (from vt-file-scan, vt-file-rescan or vt-url-scan)
    outputs:
      - contextPath: VirusTotal.Analysis.data.attributes.date
        description: Date of the analysis in epoch
        type: Number
      - contextPath: VirusTotal.Analysis.data.attributes.stats.harmless
        description: Number of engines found the indicator harmless.
        type: Number
      - contextPath: VirusTotal.Analysis.data.attributes.stats.malicious
        description: Number of engines found the indicator malicious.
        type: Number
      - contextPath: VirusTotal.Analysis.data.attributes.stats.suspicious
        description: Number of engines found the indicator suspicious.
        type: Number
      - contextPath: VirusTotal.Analysis.data.attributes.stats.timeout
        description: Number of engines found the indicator timeout.
        type: Number
      - contextPath: VirusTotal.Analysis.data.attributes.stats.undetected
        description: Number of engines found the indicator undetected.
        type: Number
      - contextPath: VirusTotal.Analysis.data.attributes.status
        description: Status of the analysis
        type: String
      - contextPath: VirusTotal.Analysis.data.id
        description: ID of the analysis.
        type: String
      - contextPath: VirusTotal.Analysis.data.type
        description: Type of object (analysis)
        type: String
      - contextPath: VirusTotal.Analysis.meta.file_info.sha256
        description: SHA-256 of the file (if file)
        type: String
      - contextPath: VirusTotal.Analysis.meta.file_info.sha1
        description: SHA-1 of the file (if file)
        type: String
      - contextPath: VirusTotal.Analysis.meta.file_info.md5
        description: MD5 of the file (if file)
        type: String
      - contextPath: VirusTotal.Analysis.meta.file_info.name
        description: name of the file (if file)
      - contextPath: VirusTotal.Analysis.meta.file_info.size
        description: Size of the file (if file)
        type: String
      - contextPath: VirusTotal.Analysis.meta.url_info.id
        description: ID of the url (if URL)
        type: String
      - contextPath: VirusTotal.Analysis.meta.url_info.url
        description: The URL (if URL)
        type: String
      - contextPath: VirusTotal.Analysis.id
        description: The analysis ID.
        type: String
    description: Retrives resolutions of the given ip.
  runonce: false
  dockerimage: demisto/python3:3.9.1.15759
tests:
- VirusTotal-V3-test-playbook
